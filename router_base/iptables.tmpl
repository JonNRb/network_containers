################################################################################
## Docker IPtables Firewall
################################################################################


-t filter -P INPUT DROP
-t filter -P FORWARD DROP
-t filter -N in-tcp
-t filter -N in-udp
-t filter -N fw-interfaces
-t filter -N fw-open


-t filter -A INPUT -j DROP -m state --state INVALID
-t filter -A INPUT -j ACCEPT -m conntrack --ctstate RELATED,ESTABLISHED
-t filter -A INPUT -j ACCEPT -i lo
-t filter -A INPUT -j ACCEPT -p icmp --icmp-type 8 -m conntrack --ctstate NEW
-t filter -A INPUT -j in-tcp -p tcp --tcp-flags FIN,SYN,RST,ACK SYN -m conntrack --ctstate NEW
-t filter -A INPUT -j in-udp -p udp -m conntrack --ctstate NEW
-t filter -A INPUT -j REJECT --reject-with icmp-proto-unreachable


 -t filter -A in-tcp -j REJECT -p tcp --reject-with tcp-reset

 -t filter -A in-udp -j REJECT -p udp --reject-with icmp-port-unreachable


-t filter -A FORWARD -j ACCEPT -m conntrack --ctstate ESTABLISHED,RELATED
-t filter -A FORWARD -j fw-interfaces
-t filter -A FORWARD -j fw-open
-t filter -A FORWARD -j REJECT --reject-with icmp-host-unreach

 -t filter -A fw-interfaces -j ACCEPT -i eth1 -o eth0


 -t nat -A PREROUTING -j ACCEPT -m conntrack --ctstate RELATED,ESTABLISHED


 -t nat -A POSTROUTING -j MASQUERADE -o eth0 -m comment --comment external-nat

